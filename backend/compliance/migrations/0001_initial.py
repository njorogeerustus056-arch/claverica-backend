# Generated by Django 5.2.7 on 2026-01-16 18:58

import backend.compliance.models
import django.db.models.deletion
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='ComplianceDashboardStats',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('period_type', models.CharField(choices=[('hourly', 'Hourly'), ('daily', 'Daily'), ('weekly', 'Weekly'), ('monthly', 'Monthly')], max_length=20)),
                ('period_start', models.DateTimeField(blank=True, null=True)),
                ('period_end', models.DateTimeField(blank=True, null=True)),
                ('total_requests', models.IntegerField(default=0)),
                ('pending_requests', models.IntegerField(default=0)),
                ('approved_requests', models.IntegerField(default=0)),
                ('rejected_requests', models.IntegerField(default=0)),
                ('escalated_requests', models.IntegerField(default=0)),
                ('kyc_submissions', models.IntegerField(default=0)),
                ('kyc_approved', models.IntegerField(default=0)),
                ('kyc_rejected', models.IntegerField(default=0)),
                ('kyc_pending', models.IntegerField(default=0)),
                ('tac_generated', models.IntegerField(default=0)),
                ('tac_verified', models.IntegerField(default=0)),
                ('tac_expired', models.IntegerField(default=0)),
                ('tac_failed', models.IntegerField(default=0)),
                ('video_calls_scheduled', models.IntegerField(default=0)),
                ('video_calls_completed', models.IntegerField(default=0)),
                ('video_calls_cancelled', models.IntegerField(default=0)),
                ('video_call_success_rate', models.FloatField(default=0.0)),
                ('high_risk_count', models.IntegerField(default=0)),
                ('medium_risk_count', models.IntegerField(default=0)),
                ('low_risk_count', models.IntegerField(default=0)),
                ('average_risk_score', models.FloatField(default=0.0)),
                ('avg_processing_time_hours', models.FloatField(default=0.0)),
                ('median_processing_time_hours', models.FloatField(default=0.0)),
                ('p90_processing_time_hours', models.FloatField(default=0.0)),
                ('payments_requests', models.IntegerField(default=0)),
                ('escrow_requests', models.IntegerField(default=0)),
                ('crypto_requests', models.IntegerField(default=0)),
                ('wallet_requests', models.IntegerField(default=0)),
                ('requests_per_officer', models.JSONField(blank=True, default=dict)),
                ('avg_resolution_time_per_officer', models.JSONField(blank=True, default=dict)),
                ('calculated_at', models.DateTimeField(auto_now_add=True, null=True)),
                ('updated_at', models.DateTimeField(auto_now=True, null=True)),
            ],
            options={
                'db_table': 'compliance_dashboard_stats',
                'ordering': ['-period_end'],
                'indexes': [models.Index(fields=['period_type', 'period_end'], name='compliance__period__ba1084_idx'), models.Index(fields=['period_end'], name='compliance__period__ce301c_idx')],
                'unique_together': {('period_type', 'period_start', 'period_end')},
            },
        ),
        migrations.CreateModel(
            name='ComplianceProfile',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('kyc_status', models.CharField(choices=[('pending', 'Pending'), ('in_review', 'In Review'), ('approved', 'Approved'), ('rejected', 'Rejected')], default='pending', max_length=20)),
                ('risk_level', models.CharField(choices=[('low', 'Low'), ('medium', 'Medium'), ('high', 'High')], default='low', max_length=20)),
                ('last_kyc_date', models.DateTimeField(blank=True, null=True)),
                ('next_kyc_review', models.DateTimeField(blank=True, null=True)),
                ('restrictions', models.JSONField(blank=True, default=dict)),
                ('created_at', models.DateTimeField(auto_now_add=True, null=True)),
                ('updated_at', models.DateTimeField(auto_now=True, null=True)),
                ('user', models.OneToOneField(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='compliance_profile', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'db_table': 'compliance_profiles',
            },
        ),
        migrations.CreateModel(
            name='KYCVerification',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('kyc_id', models.CharField(default=backend.compliance.models.generate_kyc_id, max_length=100)),
                ('first_name', models.CharField(default='', max_length=100)),
                ('middle_name', models.CharField(blank=True, max_length=100, null=True)),
                ('last_name', models.CharField(default='', max_length=100)),
                ('date_of_birth', models.DateField(blank=True, null=True)),
                ('nationality', models.CharField(default='', max_length=100)),
                ('country_of_residence', models.CharField(default='', max_length=100)),
                ('country_of_birth', models.CharField(blank=True, max_length=100, null=True)),
                ('email', models.EmailField(max_length=254)),
                ('phone_number', models.CharField(default='', max_length=20)),
                ('address_line1', models.CharField(default='', max_length=255)),
                ('address_line2', models.CharField(blank=True, max_length=255, null=True)),
                ('city', models.CharField(default='', max_length=100)),
                ('state_province', models.CharField(blank=True, max_length=100, null=True)),
                ('postal_code', models.CharField(default='', max_length=20)),
                ('id_number', models.CharField(default='', max_length=100)),
                ('id_type', models.CharField(choices=[('passport', 'Passport'), ('national_id', 'National ID'), ('drivers_license', "Driver's License"), ('utility_bill', 'Utility Bill'), ('bank_statement', 'Bank Statement'), ('proof_of_address', 'Proof of Address'), ('selfie', 'Selfie with ID'), ('tax_document', 'Tax Document'), ('incorporation_certificate', 'Incorporation Certificate'), ('business_license', 'Business License')], default='', max_length=30)),
                ('id_issue_date', models.DateField(blank=True, null=True)),
                ('id_expiry_date', models.DateField(blank=True, null=True)),
                ('id_issuing_country', models.CharField(blank=True, max_length=100, null=True)),
                ('company_name', models.CharField(blank=True, max_length=255, null=True)),
                ('company_registration_number', models.CharField(blank=True, max_length=100, null=True)),
                ('business_nature', models.CharField(blank=True, max_length=255, null=True)),
                ('website', models.URLField(blank=True, null=True)),
                ('occupation', models.CharField(blank=True, max_length=100, null=True)),
                ('employer_name', models.CharField(blank=True, max_length=255, null=True)),
                ('employment_status', models.CharField(blank=True, choices=[('employed', 'Employed'), ('self_employed', 'Self-Employed'), ('unemployed', 'Unemployed'), ('student', 'Student'), ('retired', 'Retired')], max_length=50, null=True)),
                ('annual_income', models.DecimalField(blank=True, decimal_places=2, max_digits=12, null=True)),
                ('income_currency', models.CharField(default='USD', max_length=3)),
                ('source_of_funds', models.TextField(blank=True, null=True)),
                ('expected_monthly_volume', models.DecimalField(blank=True, decimal_places=2, max_digits=12, null=True)),
                ('purpose_of_account', models.TextField(blank=True, null=True)),
                ('verification_status', models.CharField(choices=[('pending', 'Pending'), ('in_review', 'In Review'), ('approved', 'Approved'), ('rejected', 'Rejected'), ('expired', 'Expired')], default='pending', max_length=20)),
                ('compliance_level', models.CharField(choices=[('basic', 'Basic'), ('standard', 'Standard'), ('enhanced', 'Enhanced'), ('premium', 'Premium')], default='basic', max_length=20)),
                ('risk_score', models.FloatField(default=0.0)),
                ('risk_level', models.CharField(default='low', max_length=20)),
                ('risk_factors', models.JSONField(blank=True, default=list)),
                ('pep_status', models.BooleanField(default=False)),
                ('pep_details', models.TextField(blank=True, null=True)),
                ('sanctions_match', models.BooleanField(default=False)),
                ('sanctions_details', models.JSONField(blank=True, default=dict)),
                ('submitted_at', models.DateTimeField(auto_now_add=True, null=True)),
                ('verified_at', models.DateTimeField(blank=True, null=True)),
                ('review_notes', models.TextField(blank=True, null=True)),
                ('rejection_reason', models.TextField(blank=True, null=True)),
                ('documents_submitted', models.IntegerField(default=0)),
                ('documents_approved', models.IntegerField(default=0)),
                ('documents_rejected', models.IntegerField(default=0)),
                ('pep_check_completed', models.BooleanField(default=False)),
                ('sanctions_check_completed', models.BooleanField(default=False)),
                ('adverse_media_check_completed', models.BooleanField(default=False)),
                ('document_verification_completed', models.BooleanField(default=False)),
                ('created_at', models.DateTimeField(auto_now_add=True, null=True)),
                ('updated_at', models.DateTimeField(auto_now=True, null=True)),
                ('next_review_date', models.DateTimeField(blank=True, null=True)),
                ('ip_address', models.GenericIPAddressField(blank=True, null=True)),
                ('user_agent', models.TextField(blank=True, null=True)),
                ('metadata', models.JSONField(blank=True, default=dict)),
                ('user', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='kyc_verifications', to=settings.AUTH_USER_MODEL)),
                ('verified_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='verified_kyc_records', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'db_table': 'kyc_verifications',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='KYCDocument',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('document_id', models.CharField(default=backend.compliance.models.generate_document_id, max_length=100)),
                ('document_type', models.CharField(choices=[('passport', 'Passport'), ('national_id', 'National ID'), ('drivers_license', "Driver's License"), ('utility_bill', 'Utility Bill'), ('bank_statement', 'Bank Statement'), ('proof_of_address', 'Proof of Address'), ('selfie', 'Selfie with ID'), ('tax_document', 'Tax Document'), ('incorporation_certificate', 'Incorporation Certificate'), ('business_license', 'Business License')], default='', max_length=50)),
                ('document_number', models.CharField(blank=True, max_length=100, null=True)),
                ('document_name', models.CharField(default='Unnamed Document', max_length=255)),
                ('file_name', models.CharField(default='', max_length=255)),
                ('original_file_name', models.CharField(default='', max_length=255)),
                ('file_path', models.CharField(default='', max_length=500)),
                ('file_url', models.URLField(blank=True, null=True)),
                ('file_size', models.IntegerField(default=0)),
                ('file_type', models.CharField(default='', max_length=100)),
                ('file_hash', models.CharField(blank=True, max_length=64, null=True)),
                ('issue_date', models.DateField(blank=True, null=True)),
                ('expiry_date', models.DateField(blank=True, null=True)),
                ('issuing_country', models.CharField(blank=True, max_length=100, null=True)),
                ('issuing_authority', models.CharField(blank=True, max_length=255, null=True)),
                ('status', models.CharField(choices=[('pending', 'Pending Review'), ('approved', 'Approved'), ('rejected', 'Rejected'), ('expired', 'Expired')], default='pending', max_length=20)),
                ('verified_at', models.DateTimeField(blank=True, null=True)),
                ('verification_method', models.CharField(blank=True, choices=[('manual', 'Manual Review'), ('automated', 'Automated Check'), ('third_party', 'Third Party Service')], max_length=50, null=True)),
                ('ocr_data', models.JSONField(blank=True, default=dict)),
                ('extracted_data', models.JSONField(blank=True, default=dict)),
                ('confidence_score', models.FloatField(blank=True, null=True)),
                ('notes', models.TextField(blank=True, null=True)),
                ('rejection_reason', models.TextField(blank=True, null=True)),
                ('is_encrypted', models.BooleanField(default=False)),
                ('encryption_key', models.CharField(blank=True, max_length=255, null=True)),
                ('uploaded_at', models.DateTimeField(auto_now_add=True, null=True)),
                ('updated_at', models.DateTimeField(auto_now=True, null=True)),
                ('user', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='kyc_documents', to=settings.AUTH_USER_MODEL)),
                ('verified_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='verified_documents', to=settings.AUTH_USER_MODEL)),
                ('kyc_verification', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='documents', to='compliance.kycverification')),
            ],
            options={
                'db_table': 'kyc_documents',
                'ordering': ['-uploaded_at'],
            },
        ),
        migrations.CreateModel(
            name='ComplianceRequest',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('compliance_id', models.CharField(default=backend.compliance.models.generate_compliance_id, max_length=100)),
                ('app_name', models.CharField(choices=[('payments', 'Payments App'), ('escrow', 'Escrow App'), ('crypto', 'Crypto App'), ('wallet', 'Wallet System'), ('loan', 'Loan App'), ('investment', 'Investment App')], default='', max_length=50)),
                ('app_transaction_id', models.CharField(blank=True, max_length=100, null=True)),
                ('user_email', models.EmailField(max_length=254)),
                ('user_phone', models.CharField(blank=True, max_length=20, null=True)),
                ('request_type', models.CharField(choices=[('manual_payment', 'Manual Payment Release'), ('kyc_verification', 'KYC Verification'), ('withdrawal_approval', 'Withdrawal Approval'), ('deposit_verification', 'Deposit Verification'), ('transaction_limit', 'Transaction Limit Increase'), ('account_verification', 'Account Verification'), ('document_verification', 'Document Verification'), ('risk_review', 'Risk Review'), ('sanctions_check', 'Sanctions Check')], default='', max_length=50)),
                ('amount', models.DecimalField(blank=True, decimal_places=2, max_digits=15, null=True)),
                ('currency', models.CharField(default='USD', max_length=3)),
                ('description', models.TextField(blank=True, null=True)),
                ('status', models.CharField(choices=[('pending', 'Pending Review'), ('under_review', 'Under Review'), ('info_required', 'Additional Info Required'), ('kyc_requested', 'KYC Form Requested'), ('video_call_scheduled', 'Video Call Scheduled'), ('awaiting_tac', 'Awaiting TAC Verification'), ('approved', 'Approved'), ('rejected', 'Rejected'), ('cancelled', 'Cancelled')], default='pending', max_length=30)),
                ('priority', models.CharField(choices=[('low', 'Low'), ('normal', 'Normal'), ('high', 'High'), ('urgent', 'Urgent')], default='normal', max_length=20)),
                ('requires_kyc', models.BooleanField(default=False)),
                ('requires_video_call', models.BooleanField(default=False)),
                ('requires_tac', models.BooleanField(default=False)),
                ('requires_manual_review', models.BooleanField(default=False)),
                ('risk_score', models.FloatField(default=0.0)),
                ('risk_level', models.CharField(choices=[('low', 'Low'), ('medium', 'Medium'), ('high', 'High'), ('very_high', 'Very High')], default='low', max_length=20)),
                ('tac_code', models.CharField(blank=True, max_length=10, null=True)),
                ('tac_generated_at', models.DateTimeField(blank=True, null=True)),
                ('tac_verified_at', models.DateTimeField(blank=True, null=True)),
                ('video_call_scheduled_at', models.DateTimeField(blank=True, null=True)),
                ('video_call_link', models.URLField(blank=True, null=True)),
                ('video_call_completed_at', models.DateTimeField(blank=True, null=True)),
                ('video_call_duration', models.IntegerField(blank=True, null=True)),
                ('video_call_notes', models.TextField(blank=True, null=True)),
                ('reviewed_at', models.DateTimeField(blank=True, null=True)),
                ('review_notes', models.TextField(blank=True, null=True)),
                ('form_data', models.JSONField(blank=True, default=dict)),
                ('documents', models.JSONField(blank=True, default=list)),
                ('decision', models.CharField(blank=True, choices=[('approve', 'Approve'), ('reject', 'Reject'), ('pending', 'Pending'), ('escalate', 'Escalate')], max_length=20, null=True)),
                ('decision_reason', models.TextField(blank=True, null=True)),
                ('decision_notes', models.TextField(blank=True, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True, null=True)),
                ('updated_at', models.DateTimeField(auto_now=True, null=True)),
                ('resolved_at', models.DateTimeField(blank=True, null=True)),
                ('expires_at', models.DateTimeField(blank=True, null=True)),
                ('ip_address', models.GenericIPAddressField(blank=True, null=True)),
                ('user_agent', models.TextField(blank=True, null=True)),
                ('metadata', models.JSONField(blank=True, default=dict)),
                ('assigned_to', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='assigned_compliance_requests', to=settings.AUTH_USER_MODEL)),
                ('reviewed_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='reviewed_compliance_requests', to=settings.AUTH_USER_MODEL)),
                ('user', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='compliance_requests', to=settings.AUTH_USER_MODEL)),
                ('kyc_verification', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='compliance_requests', to='compliance.kycverification')),
            ],
            options={
                'db_table': 'compliance_requests',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='ComplianceAuditLog',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('log_id', models.CharField(default=backend.compliance.models.generate_log_id, max_length=100)),
                ('entity_type', models.CharField(choices=[('compliance_request', 'Compliance Request'), ('kyc_verification', 'KYC Verification'), ('kyc_document', 'KYC Document'), ('tac_request', 'TAC Request'), ('video_call', 'Video Call'), ('user', 'User'), ('transaction', 'Transaction')], default='', max_length=50)),
                ('entity_id', models.CharField(default='', max_length=100)),
                ('action_type', models.CharField(choices=[('create', 'Create'), ('update', 'Update'), ('delete', 'Delete'), ('approve', 'Approve'), ('reject', 'Reject'), ('verify', 'Verify'), ('escalate', 'Escalate'), ('comment', 'Comment'), ('view', 'View')], default='', max_length=50)),
                ('action_description', models.TextField(blank=True, default='No description provided')),
                ('user_email', models.EmailField(blank=True, max_length=254, null=True)),
                ('user_role', models.CharField(blank=True, max_length=50, null=True)),
                ('old_value', models.JSONField(blank=True, default=dict)),
                ('new_value', models.JSONField(blank=True, default=dict)),
                ('changed_fields', models.JSONField(blank=True, default=list)),
                ('ip_address', models.GenericIPAddressField(blank=True, null=True)),
                ('user_agent', models.TextField(blank=True, null=True)),
                ('location', models.CharField(blank=True, max_length=255, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True, null=True)),
                ('user', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='compliance_audit_logs', to=settings.AUTH_USER_MODEL)),
                ('compliance_request', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='audit_logs', to='compliance.compliancerequest')),
                ('kyc_verification', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='audit_logs', to='compliance.kycverification')),
            ],
            options={
                'db_table': 'compliance_audit_logs',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='ComplianceAlert',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('alert_id', models.CharField(default=backend.compliance.models.generate_alert_id, max_length=100)),
                ('alert_type', models.CharField(choices=[('risk_threshold', 'Risk Threshold Exceeded'), ('suspicious_activity', 'Suspicious Activity'), ('rule_violation', 'Rule Violation'), ('deadline_approaching', 'Deadline Approaching'), ('kyc_expiring', 'KYC Expiring Soon'), ('document_expiring', 'Document Expiring Soon'), ('unusual_pattern', 'Unusual Pattern Detected'), ('sanctions_match', 'Sanctions Match'), ('pep_identified', 'PEP Identified')], default='', max_length=50)),
                ('severity', models.CharField(choices=[('info', 'Info'), ('warning', 'Warning'), ('error', 'Error'), ('critical', 'Critical')], default='warning', max_length=20)),
                ('title', models.CharField(default='', max_length=255)),
                ('description', models.TextField(default='')),
                ('alert_data', models.JSONField(blank=True, default=dict)),
                ('trigger_conditions', models.JSONField(blank=True, default=dict)),
                ('is_resolved', models.BooleanField(default=False)),
                ('is_acknowledged', models.BooleanField(default=False)),
                ('acknowledged_at', models.DateTimeField(blank=True, null=True)),
                ('resolution_notes', models.TextField(blank=True, null=True)),
                ('resolved_at', models.DateTimeField(blank=True, null=True)),
                ('notified_users', models.JSONField(blank=True, default=list)),
                ('notification_sent', models.BooleanField(default=False)),
                ('notification_channels', models.JSONField(blank=True, default=list)),
                ('created_at', models.DateTimeField(auto_now_add=True, null=True)),
                ('updated_at', models.DateTimeField(auto_now=True, null=True)),
                ('expires_at', models.DateTimeField(blank=True, null=True)),
                ('acknowledged_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='acknowledged_alerts', to=settings.AUTH_USER_MODEL)),
                ('resolved_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='resolved_alerts', to=settings.AUTH_USER_MODEL)),
                ('user', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='compliance_alerts', to=settings.AUTH_USER_MODEL)),
                ('compliance_request', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='alerts', to='compliance.compliancerequest')),
                ('kyc_verification', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='alerts', to='compliance.kycverification')),
            ],
            options={
                'db_table': 'compliance_alerts',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='TACRequest',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('tac_id', models.CharField(default=backend.compliance.models.generate_tac_id, max_length=100)),
                ('tac_code', models.CharField(default='', max_length=10)),
                ('tac_type', models.CharField(choices=[('withdrawal', 'Withdrawal'), ('transfer', 'Transfer'), ('payment', 'Payment'), ('account_change', 'Account Change'), ('security', 'Security')], default='withdrawal', max_length=30)),
                ('purpose', models.TextField(blank=True, null=True)),
                ('is_used', models.BooleanField(default=False)),
                ('is_expired', models.BooleanField(default=False)),
                ('attempts', models.IntegerField(default=0)),
                ('max_attempts', models.IntegerField(default=3)),
                ('amount', models.DecimalField(blank=True, decimal_places=2, max_digits=15, null=True)),
                ('currency', models.CharField(default='USD', max_length=3)),
                ('transaction_id', models.CharField(blank=True, max_length=100, null=True)),
                ('sent_via', models.CharField(choices=[('email', 'Email'), ('sms', 'SMS'), ('push', 'Push Notification'), ('whatsapp', 'WhatsApp'), ('telegram', 'Telegram')], default='email', max_length=50)),
                ('sent_to', models.CharField(default='', max_length=255)),
                ('delivery_status', models.CharField(choices=[('pending', 'Pending'), ('sent', 'Sent'), ('delivered', 'Delivered'), ('failed', 'Failed'), ('read', 'Read')], default='pending', max_length=50)),
                ('delivery_attempts', models.IntegerField(default=0)),
                ('verified_at', models.DateTimeField(blank=True, null=True)),
                ('verification_ip', models.GenericIPAddressField(blank=True, null=True)),
                ('verification_user_agent', models.TextField(blank=True, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True, null=True)),
                ('expires_at', models.DateTimeField(blank=True, null=True)),
                ('used_at', models.DateTimeField(blank=True, null=True)),
                ('ip_address', models.GenericIPAddressField(blank=True, null=True)),
                ('user_agent', models.TextField(blank=True, null=True)),
                ('compliance_request', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='tac_requests', to='compliance.compliancerequest')),
                ('user', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='tac_requests', to=settings.AUTH_USER_MODEL)),
                ('verified_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='verified_tacs', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'db_table': 'tac_requests',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='VideoCallSession',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('session_id', models.CharField(default=backend.compliance.models.generate_session_id, max_length=100)),
                ('status', models.CharField(choices=[('scheduled', 'Scheduled'), ('in_progress', 'In Progress'), ('completed', 'Completed'), ('cancelled', 'Cancelled'), ('missed', 'Missed'), ('rescheduled', 'Rescheduled')], default='scheduled', max_length=20)),
                ('purpose', models.TextField(blank=True, null=True)),
                ('scheduled_for', models.DateTimeField(blank=True, null=True)),
                ('duration_minutes', models.IntegerField(default=30)),
                ('agent_name', models.CharField(blank=True, max_length=255, null=True)),
                ('agent_title', models.CharField(blank=True, max_length=100, null=True)),
                ('platform', models.CharField(choices=[('zoom', 'Zoom'), ('google_meet', 'Google Meet'), ('microsoft_teams', 'Microsoft Teams'), ('custom', 'Custom Platform')], default='zoom', max_length=50)),
                ('meeting_link', models.URLField()),
                ('meeting_id', models.CharField(blank=True, max_length=100, null=True)),
                ('meeting_password', models.CharField(blank=True, max_length=100, null=True)),
                ('started_at', models.DateTimeField(blank=True, null=True)),
                ('ended_at', models.DateTimeField(blank=True, null=True)),
                ('actual_duration', models.IntegerField(blank=True, null=True)),
                ('is_recorded', models.BooleanField(default=False)),
                ('recording_url', models.URLField(blank=True, null=True)),
                ('recording_duration', models.IntegerField(blank=True, null=True)),
                ('transcription', models.TextField(blank=True, null=True)),
                ('verification_passed', models.BooleanField(default=False)),
                ('verification_notes', models.TextField(blank=True, null=True)),
                ('issues_identified', models.JSONField(blank=True, default=list)),
                ('follow_up_required', models.BooleanField(default=False)),
                ('follow_up_notes', models.TextField(blank=True, null=True)),
                ('ip_address_user', models.GenericIPAddressField(blank=True, null=True)),
                ('ip_address_agent', models.GenericIPAddressField(blank=True, null=True)),
                ('user_notified', models.BooleanField(default=False)),
                ('agent_notified', models.BooleanField(default=False)),
                ('reminder_sent', models.BooleanField(default=False)),
                ('created_at', models.DateTimeField(auto_now_add=True, null=True)),
                ('updated_at', models.DateTimeField(auto_now=True, null=True)),
                ('agent', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='agent_video_calls', to=settings.AUTH_USER_MODEL)),
                ('compliance_request', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='video_calls', to='compliance.compliancerequest')),
                ('user', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='video_calls', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'db_table': 'video_call_sessions',
                'ordering': ['scheduled_for'],
            },
        ),
        migrations.CreateModel(
            name='ComplianceRule',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('rule_id', models.CharField(default=backend.compliance.models.generate_rule_id, max_length=100)),
                ('rule_name', models.CharField(default='', max_length=255)),
                ('rule_description', models.TextField(default='')),
                ('rule_type', models.CharField(choices=[('amount_limit', 'Amount Limit'), ('frequency_limit', 'Frequency Limit'), ('velocity_limit', 'Velocity Limit'), ('geographic_restriction', 'Geographic Restriction'), ('document_requirement', 'Document Requirement'), ('risk_threshold', 'Risk Threshold'), ('kyc_requirement', 'KYC Requirement'), ('sanctions_check', 'Sanctions Check')], default='', max_length=50)),
                ('applicable_apps', models.CharField(choices=[('all', 'All Apps'), ('payments', 'Payments Only'), ('escrow', 'Escrow Only'), ('crypto', 'Crypto Only'), ('wallet', 'Wallet Only'), ('loan', 'Loan Only'), ('investment', 'Investment Only')], default='all', max_length=50)),
                ('priority', models.IntegerField(default=1)),
                ('condition', models.JSONField(blank=True, default=dict)),
                ('threshold_amount', models.DecimalField(blank=True, decimal_places=2, max_digits=15, null=True)),
                ('threshold_currency', models.CharField(default='USD', max_length=3)),
                ('time_period', models.CharField(blank=True, choices=[('daily', 'Daily'), ('weekly', 'Weekly'), ('monthly', 'Monthly'), ('yearly', 'Yearly'), ('per_transaction', 'Per Transaction')], max_length=50, null=True)),
                ('action', models.CharField(choices=[('allow', 'Allow'), ('deny', 'Deny'), ('review', 'Require Review'), ('escalate', 'Escalate'), ('notify', 'Notify'), ('limit', 'Apply Limit')], default='', max_length=50)),
                ('action_details', models.JSONField(blank=True, default=dict)),
                ('risk_weight', models.FloatField(default=1.0)),
                ('risk_multiplier', models.FloatField(default=1.0)),
                ('is_active', models.BooleanField(default=True)),
                ('is_automated', models.BooleanField(default=True)),
                ('notes', models.TextField(blank=True, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True, null=True)),
                ('updated_at', models.DateTimeField(auto_now=True, null=True)),
                ('effective_from', models.DateTimeField(blank=True, null=True)),
                ('effective_to', models.DateTimeField(blank=True, null=True)),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'db_table': 'compliance_rules',
                'ordering': ['priority', 'rule_name'],
                'indexes': [models.Index(fields=['rule_id'], name='compliance__rule_id_b8c5b2_idx'), models.Index(fields=['rule_type', 'is_active'], name='compliance__rule_ty_6202b8_idx'), models.Index(fields=['applicable_apps', 'is_active'], name='compliance__applica_e9beea_idx'), models.Index(fields=['is_active'], name='compliance__is_acti_012abc_idx')],
            },
        ),
        migrations.AddIndex(
            model_name='kycverification',
            index=models.Index(fields=['kyc_id'], name='kyc_verific_kyc_id_3e324e_idx'),
        ),
        migrations.AddIndex(
            model_name='kycverification',
            index=models.Index(fields=['user', 'verification_status'], name='kyc_verific_user_id_d6c68f_idx'),
        ),
        migrations.AddIndex(
            model_name='kycverification',
            index=models.Index(fields=['verification_status'], name='kyc_verific_verific_6493d0_idx'),
        ),
        migrations.AddIndex(
            model_name='kycverification',
            index=models.Index(fields=['risk_level'], name='kyc_verific_risk_le_97d91d_idx'),
        ),
        migrations.AddIndex(
            model_name='kycverification',
            index=models.Index(fields=['created_at'], name='kyc_verific_created_6e0e6a_idx'),
        ),
        migrations.AddIndex(
            model_name='kycdocument',
            index=models.Index(fields=['document_id'], name='kyc_documen_documen_ff33e0_idx'),
        ),
        migrations.AddIndex(
            model_name='kycdocument',
            index=models.Index(fields=['kyc_verification', 'document_type'], name='kyc_documen_kyc_ver_9bdc5e_idx'),
        ),
        migrations.AddIndex(
            model_name='kycdocument',
            index=models.Index(fields=['user', 'status'], name='kyc_documen_user_id_19faeb_idx'),
        ),
        migrations.AddIndex(
            model_name='kycdocument',
            index=models.Index(fields=['status'], name='kyc_documen_status_355905_idx'),
        ),
        migrations.AddIndex(
            model_name='kycdocument',
            index=models.Index(fields=['uploaded_at'], name='kyc_documen_uploade_c18557_idx'),
        ),
        migrations.AddIndex(
            model_name='compliancerequest',
            index=models.Index(fields=['compliance_id'], name='compliance__complia_2f0045_idx'),
        ),
        migrations.AddIndex(
            model_name='compliancerequest',
            index=models.Index(fields=['app_name', 'app_transaction_id'], name='compliance__app_nam_50c261_idx'),
        ),
        migrations.AddIndex(
            model_name='compliancerequest',
            index=models.Index(fields=['user', 'status'], name='compliance__user_id_494a50_idx'),
        ),
        migrations.AddIndex(
            model_name='compliancerequest',
            index=models.Index(fields=['status', 'priority'], name='compliance__status_d8214a_idx'),
        ),
        migrations.AddIndex(
            model_name='compliancerequest',
            index=models.Index(fields=['created_at'], name='compliance__created_79cfe9_idx'),
        ),
        migrations.AddIndex(
            model_name='compliancerequest',
            index=models.Index(fields=['assigned_to', 'status'], name='compliance__assigne_d8a8a6_idx'),
        ),
        migrations.AddIndex(
            model_name='complianceauditlog',
            index=models.Index(fields=['log_id'], name='compliance__log_id_ae969e_idx'),
        ),
        migrations.AddIndex(
            model_name='complianceauditlog',
            index=models.Index(fields=['entity_type', 'entity_id'], name='compliance__entity__1243fe_idx'),
        ),
        migrations.AddIndex(
            model_name='complianceauditlog',
            index=models.Index(fields=['user', 'created_at'], name='compliance__user_id_dcd096_idx'),
        ),
        migrations.AddIndex(
            model_name='complianceauditlog',
            index=models.Index(fields=['compliance_request', 'created_at'], name='compliance__complia_80d1d0_idx'),
        ),
        migrations.AddIndex(
            model_name='complianceauditlog',
            index=models.Index(fields=['created_at'], name='compliance__created_60dfc5_idx'),
        ),
        migrations.AddIndex(
            model_name='compliancealert',
            index=models.Index(fields=['alert_id'], name='compliance__alert_i_ab48e2_idx'),
        ),
        migrations.AddIndex(
            model_name='compliancealert',
            index=models.Index(fields=['alert_type', 'is_resolved'], name='compliance__alert_t_9ec76f_idx'),
        ),
        migrations.AddIndex(
            model_name='compliancealert',
            index=models.Index(fields=['severity', 'created_at'], name='compliance__severit_2aa34f_idx'),
        ),
        migrations.AddIndex(
            model_name='compliancealert',
            index=models.Index(fields=['is_resolved', 'created_at'], name='compliance__is_reso_7ac8c4_idx'),
        ),
        migrations.AddIndex(
            model_name='compliancealert',
            index=models.Index(fields=['created_at'], name='compliance__created_ac68c5_idx'),
        ),
        migrations.AddIndex(
            model_name='tacrequest',
            index=models.Index(fields=['tac_id'], name='tac_request_tac_id_60d818_idx'),
        ),
        migrations.AddIndex(
            model_name='tacrequest',
            index=models.Index(fields=['user', 'is_used', 'is_expired'], name='tac_request_user_id_2cdc3c_idx'),
        ),
        migrations.AddIndex(
            model_name='tacrequest',
            index=models.Index(fields=['tac_code'], name='tac_request_tac_cod_6ee9ea_idx'),
        ),
        migrations.AddIndex(
            model_name='tacrequest',
            index=models.Index(fields=['expires_at'], name='tac_request_expires_780edb_idx'),
        ),
        migrations.AddIndex(
            model_name='tacrequest',
            index=models.Index(fields=['created_at'], name='tac_request_created_94041b_idx'),
        ),
        migrations.AddIndex(
            model_name='videocallsession',
            index=models.Index(fields=['session_id'], name='video_call__session_92bc76_idx'),
        ),
        migrations.AddIndex(
            model_name='videocallsession',
            index=models.Index(fields=['compliance_request'], name='video_call__complia_c59e2b_idx'),
        ),
        migrations.AddIndex(
            model_name='videocallsession',
            index=models.Index(fields=['user', 'status'], name='video_call__user_id_08ee5b_idx'),
        ),
        migrations.AddIndex(
            model_name='videocallsession',
            index=models.Index(fields=['agent', 'status'], name='video_call__agent_i_95db0d_idx'),
        ),
        migrations.AddIndex(
            model_name='videocallsession',
            index=models.Index(fields=['scheduled_for'], name='video_call__schedul_9d301e_idx'),
        ),
        migrations.AddIndex(
            model_name='videocallsession',
            index=models.Index(fields=['status', 'scheduled_for'], name='video_call__status_f7b88f_idx'),
        ),
    ]
